<!DOCTYPE html>
<html lang="fr">
<head>
    <title>Dr Sanna</title>
    <link rel="preload" href="/icones/arrow-left-solid.svg" as="image">
           <style>
  #loader {
  transition: all 0.3s ease-out;
  opacity: 1;
  visibility: visible;
  position: fixed;
  height: 100vh;
  width: 100vw;
  background: black;
  z-index: 9999;
  display: flex;
  justify-content: center;
  align-items: center;
}

#loader.fadeOut {
  opacity: 0;
  visibility: hidden;
}

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  font-family: Arial, sans-serif;
  display: flex;
background: dimgray
}

#title-container {
  width: 33.33%;
  max-height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  color: white;
}

#table-container {
  width: 66.67%;
  max-height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  padding: 50px;
}

table {
  border-collapse: separate;
  width: 100%;
  height: 100%;
}

td {
  background-color: seashell;
  box-sizing: border-box;
  overflow: hidden;
  position: relative;
  z-index: 0;
}

.cell-content {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  word-wrap: break-word;
  font-weight: bold;
  color: black;
  transition: none;
}

.square-cell {
  width: calc(100% - 20px);
  height: calc(100% - 20px);
  padding: 10px;
  position: relative;
}

.square-cell .cell-content {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

#title-container td {
  border: 1px solid black;
  background-color: seashell;
  color: white;
}

#title-container tr:first-child .cell-content {
  font-size: 1.2em;
  font-family: "Arial Black", Arial, sans-serif;
}

#table-container > table {
  border-collapse: separate;
  width: 100%;
  height: 100%;
}

#table-container td {
  position: relative;
  z-index: 0;
  border: 2px solid black;
}

#table-container td:hover {
  cursor: pointer;
  transform: scale(1.2) translateZ(0);
  border: 2px solid black;
  border-radius: 25px;
  outline: 5px solid indianred;;
  z-index: 1;
  background-color: seashell;
}

#table-container tr .cell-content {
  font-size: 15px;
  text-transform: none;
  font-family: Arial, sans-serif;
}

.cell-content a {
  text-decoration: none;
  color: inherit;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cell-content a:hover {
  background-color: transparent;
}

.arrow-left-icon {
  width: 8em;
  height: 8em; 
}
.hidden {
  display: none;
}
.content-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
}

.content-image {
  max-height: 70%;
  max-width: 100%;
}

.content-text {
  text-align: center;
  margin-top: 10px;
}

</style>
</head>
<body>
        <div id="loader">
       <img src="https://i.giphy.com/media/Rk3PlFCDTXAKBjWUvR/giphy.webp" alt="Loading...">
    </div>
    <div id="title-container">
        <table>
        <tr>
            <td style="height: 33.33%;">
                <div id="dr-sanna-cell" class="cell-content">DR SANNA'S COURSES TOOL</div>
            </td>
        </tr>
            <tr>
                <td style="height: 66.67%;"><div class="cell-content"></div></td>
            </tr>
        </table>
    </div>
    <div id="table-container">
        <table>
            <tr>
                <td class="square-cell" id="cell-1"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-2"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-3"><div class="cell-content"></div></td>
            </tr>
            <tr>
                <td class="square-cell" id="cell-4"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-5"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-6"><div class="cell-content"></div></td>
            </tr>
            <tr>
                <td class="square-cell" id="cell-7"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-8"><div class="cell-content"></div></td>
                <td class="square-cell" id="cell-9"><div class="cell-content"></div></td>
            </tr>
        </table>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
$(document).ready(function(){
  let initialContent = {};
  let isBack = false;
  let initialTitle = $('#dr-sanna-cell').text();

  // Dossier contenant les images à précharger
  const imageFolder = '/icones/';
  // Tableau pour stocker les noms des images à précharger
  const imageFileNames = [];

  $.getJSON("/data/MainMenu.json", function(data) {
    const cellDataMap = {};
    data.forEach(item => {
      cellDataMap[item['1']] = item;
    });

    initialContent = cellDataMap["MainMenu"];
    updateCells(initialContent); 

    for (let i = 1; i <= 9; i++) {
      $('#cell-' + i).click(function(){
        if (isBack && i === 1) {
          updateCells(initialContent);
          $('#dr-sanna-cell').text(initialTitle);
          isBack = false;
        } else if (!isBack) {
          const cellData = cellDataMap['cell-' + i];
          const index = i + 1;
          const cellDataItem = cellDataMap["MainMenu"][index.toString()];

          updateCells(cellData);
          $('#dr-sanna-cell').text(cellDataItem);
          isBack = true;
        }
      });
    }
  });

  function updateCells(cellData) {
    for (let j = 1; j <= 9; j++) {
      $('#cell-' + j + ' .cell-content').empty();
      $('#cell-' + j).css('visibility', 'visible');
    }
    for (let j = 1; j <= 9; j++) {
      const cellContentElement = $('#cell-' + j + ' .cell-content');
      const cellDataItem = cellData[j + 1];
      if (cellDataItem) {
        if (typeof cellDataItem === 'object' && cellDataItem.hasOwnProperty('text') && cellDataItem.hasOwnProperty('link')) {
          const link = $('<a>').addClass('no-underline').attr({
            'href': cellDataItem.link,
            'target': '_blank'
          }).text(cellDataItem.text);
          cellContentElement.empty().append(link);
        } else if (cellDataItem === '/icones/arrow-left-solid.svg') {
          const icon = $('<img>').attr('src', '/icones/arrow-left-solid.svg').addClass('arrow-left-icon');
          cellContentElement.empty().append(icon);
        } else {
          const imageSrc = imageFolder + cellDataItem.toLowerCase().replace(/\s/g, '-').replace('/', '-').toLowerCase() + '.png';
          const image = $('<img>').addClass('content-image').attr('src', imageSrc);
          const text = $('<span>').addClass('content-text').text(cellDataItem);
          const content = $('<div>').addClass('content-container').append(image).append(text);
          cellContentElement.empty().append(content);
        }
      } else {
        $('#cell-' + j).css('visibility', 'hidden');
      }
    }
  }

  // Fonction pour précharger les images
  function preloadImages(imageUrls, callback) {
    const totalCount = imageUrls.length;
    let loadedCount = 0;

    // Fonction de rappel lorsqu'une image est chargée
    function imageLoaded() {
      loadedCount++;
      if (loadedCount === totalCount) {
        callback();
      }
    }

    // Préchargement de chaque image
    imageUrls.forEach(function(imageUrl) {
      const image = new Image();
      image.onload = imageLoaded;
      image.onerror = imageLoaded; // Gère les erreurs de chargement des images
      image.src = imageUrl;
    });
  }

  // Fonction pour obtenir les URL des images à précharger
  function getImageUrls() {
    const imageUrls = [];
    $('img.content-image').each(function() {
      const imageUrl = $(this).attr('src');
      imageUrls.push(imageUrl);
    });
    return imageUrls;
  }

  // Obtenir les noms de fichier des images dans le dossier
  $.ajax({
    url: imageFolder,
    success: function(data) {
      $(data).find('a:contains(".png")').each(function() {
        const fileName = $(this).attr("href");
        imageFileNames.push(imageFolder + fileName);
      });

      // Précharger les images
      preloadImages(imageFileNames, function() {
        // Toutes les images sont chargées, masquer le loader
        $("#loader").fadeOut("slow");
      });
    }
  });
});
</script>
     <script>
$(window).on("load", function() {
    if ('fonts' in document) {
        Promise.all([
            document.fonts.load('1em Arial Black')
        ]).then(function () {
            $("#loader").fadeOut("slow");
        });
    } else {
        // Fallback for browsers that do not support the font loading API
        $("#loader").fadeOut("slow");
    }
});
    </script>
</body>
</html>

